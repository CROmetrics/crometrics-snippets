'use strict';(function(){function a(a){function b(b){let c=a.indexOf(b);a[c]&&a.splice(c,1)}function c(a){window.optly.ui.showCustomDialog({title:'Results',message:a})}a.map((a)=>{return a.replace(/\s*[\[{(]primary[)}\]]\s*$/i,'')});let d=window.optly.page.experiment.projectId,e=window.optly.page.experiment.experimentId,f=window.optly.page.goalDialog.stateStack;a.length&&$.get('https://app.optimizely.com/api/project/'+d+'/goal.json?unaddable_included_experiment_id='+e,function(d){let f=[],h=(d.goals||{}).filter(function(a){return!(-1!==a.experiment_ids.indexOf(e))||(b(a.title),!1)});var j=[];for(var k in a){let b,c=a[k];for(var i in h){let a=h[i];if(a.title===c)if(!b)b=a;else{console.log('found duplicate of ',c),b=void 0;break}}b?(f.push(b),console.log('Found',c)):(j.push(c),console.log('Unable to find',c))}if(f.length)for(var i in c('Adding these goals to the experiment:\n'+f.map((a)=>a.title).join(',\n')),console.log('Adding these goals to the experiment:',f),f){let a=f[i];$.post('https://app.optimizely.com/api/experiments/'+e+'/goal.json',{goal_id:a.goal_id},function(b){b.succeeded?console.log('Successfully added goal:',a.title):(c('API ERROR!'),console.warn('API error:',b))})}else c('No goals to be added.'),console.log('No goals to be added.');j.length&&(c('Unable to add these goals:\n'+j.join(',\n')),console.warn('Unable to add these goals:',j))})}let b={template:'\n    <div class="dialog--narrow lego-dialog">\n      <div class="lego-dialog__header">\n        <div class="lego-dialog__title">'+tr('[[ title ]]')+'</div>\n        </div> <div class="lego-dialog__body">\n          <p class="weight--bold" data-test-section="alert-dialog-message">'+tr('[[ description ]]')+'</p>\n          <textarea id="text" style="width: 100%; height: 200px; resize: vertical;"></textarea>\n        </div>\n        <div class="lego-dialog__footer lego-button-row--right">\n          <button type="button" class="lego-button lego-button--plain" v-hide-dialog="" data-test-section="confirm-cancel-button">'+tr('[[ cancelText ]]')+'</button>\n          <button type="submit" class="lego-button" data-test-section="confirm-submit-button" v-class="lego-button--danger: isWarning, lego-button--highlight: !isWarning" v-on="click: accept">'+tr('[[ confirmText ]]')+'</button>\n        </div>\n      </div>\n    </div>',methods:{accept:function(){let b=$(this.$el).find('#text').val().split('\n');a(b),this.$dispatch('hideDialog')}},defaultData:{title:'Quick-Add Goals',description:'Paste in goals (one per line) to be added to the experiment:',confirmText:'Accept',cancelText:'Cancel'}};window.optly.ui.showDialog({component:b})})();