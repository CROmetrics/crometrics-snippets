'use strict';(function(){function a(a){var b=input_list.indexOf(a);input_list[b]&&input_list.splice(b,1)}(function get_goal_list(a){'https://trello.com'===location.origin.toLowerCase()?$.get(location.origin+location.pathname+'.json',function(b){for(var c,d=/^##+ ?/.test(b.desc)?b.desc.split(/##+ ?([\w ]+):? ?\n*/g):b.desc.split(/\*\*([\w ]+):? ?\*\*\n*/g),e=0;e<d.length;e++)if(c=d[e],/^\s*Goals?\s*/i.test(c)){var f=d[e+1].trim().split('\n');return void a(f)}}):a(prompt('Paste in goals, one per line and they will be added to the experiment:').split('\n'))})(function(a){a.map(function(a){return a.replace(/\s*[\[{(]primary[)}\]]\s*$/i,'')})}),input_list.map(function(a){return a.replace(/\s*[\[{(]primary[)}\]]\s*$/i,'')});var b=window.optly.page.experiment.projectId,c=window.optly.page.experiment.experimentId,d=window.optly.page.goalDialog.stateStack;input_list.length&&$.get('https://app.optimizely.com/api/project/'+b+'/goal.json?unaddable_included_experiment_id='+c,function(b){var d=[],e=(b.goals||{}).filter(function(b){return!(-1!==b.experiment_ids.indexOf(c))||(a(b.title),!1)}),f=[];for(var h in input_list){var j=void 0,k=input_list[h];for(var i in e){var l=e[i];if(l.title===k)if(!j)j=l;else{console.log('found duplicate of ',k),j=void 0;break}}j?(d.push(j),console.log('found',k)):(f.push(k),console.log('Unable to find',k))}if(d.length){alert('Adding these goals to the experiment:\n'+d.map(function(a){return a.title}).join(',\n')),console.log('Adding these goals to the experiment:',d);var g=function(){var a=d[i];$.post('https://app.optimizely.com/api/experiments/'+c+'/goal.json',{goal_id:a.goal_id},function(b){b.succeeded?console.log('Successfully added goal:',a.title):(alert('API ERROR!'),console.warn('API error:',b))})};for(var i in d)g()}else console.log('No goals to be added.');f.length&&(alert('Unable to add these goals:\n'+f.join(',\n')),console.warn('Unable to add these goals:',f))})})();