(function(){'use strict';let a=window.jQuery||window.$||window.optimizely&&window.optimizely.$;if(!a||!a.fn||!a.fn.jquery)return void alert('jQuery is required, but not found.');const b=['success','danger','warning','primary','info'];class c extends HTMLElement{constructor(){super();let b=this.attachShadow({mode:'closed'}),d=document.createElement('style');if(d.innerHTML=c.styles,this.$container=a('<div id=\'opt_container\'/>'),this.$backdrop=a('<div id=\'opt_backdrop\'/>').click(()=>{this.remove()}),b.appendChild(d),b.appendChild(this.$container[0]),b.appendChild(this.$backdrop[0]),!window.optimizely)return this.$container.append('<h1>Error: Missing Optimizely.</h1>');if(!a)return this.$container.append('<h1>Error: Missing jQuery.</h1>');let e=window.optimizely.data||{},f=window.optimizely.get&&window.optimizely.get('data')||{};this.X=!!window.optimizely.get,this.C=!!window.optimizely.getAccountId,this.state=e.state||{},this.audiences=e.audiences||{},this.xAudiences=f.audiences||{},this.variations=e.variations||{},this.xVariations=f.variations||{},this.experiments=e.experiments||{},this.xExperiments=f.experiments||{},this.xCampaigns=f.campaigns||{},this.segments=e.segments||{},this.visitor=e.visitor||{},this.accountId=f.accountId||window.optimizely.getAccountId(),this.revision=optimizely.revision||f.revision,this.launch(),a(window).resize(this.resize),this.resize()}resize(){let b=a(window).width(),c=a(window).height();this.$container.css({height:c/1.25+'px',width:b/1.5+'px',"margin-top":'-'+c/2.5+'px',"margin-left":'-'+b/3+'px'})}launch(){let b=a('\n        <div id="ooo_container" class="container">\n          <section id="ooo_container_visitors" class="container">\n            <div class="well"><br>\n              <h1 class="header center">This Site: <b>'+window.location.host+'</b></h1>\n              <div id=\'account_stats\' class="row">\n                <div class="col">\n                  <div>'+(this.X?'OptX(\u2714)':'OptX(\u2717)')+'</div><div>'+(this.C?'Classic(\u2714)':'Classic(\u2717)')+'</div>\n                </div>\n                <div class="col">\n                  <u>Account Owner</u><br><span>'+this.accountId+'</span>\n                </div>\n                <div class="col">\n                  <u>Snippet Revision</u><br><span>'+this.revision+'</span>\n                </div>\n                <div class="col">\n                  <u>Approx. Library Size</u><br><span>'+(JSON.stringify(window.optimizely).length/1e3).toFixed()+' KB</span>\n                </div>\n              </div>\n              <div class="row">\n                <div class="col">\n                  <u>X Experiments</u><br><span>'+Object.keys(this.xExperiments).length+'</span>\n                </div>\n                <div class="col">\n                  <u>X Variations</u><br><span>'+Object.keys(this.xVariations).length+'</span>\n                </div>\n                <div class="col">\n                  <u>X Audiences</u><br><span>'+Object.keys(this.xAudiences).length+'</span>\n                </div>\n                <div class="col">\n                  <u>X Campaigns</u><br><span>'+Object.keys(this.xCampaigns).length+'</span>\n                </div>\n              </div>\n              <div class="row">\n                <div class="col">\n                  <u>Classic Experiments</u><br><span>'+Object.keys(this.experiments).length+'</span>\n                </div>\n                <div class="col">\n                  <u>Classic Variations</u><br><span>'+Object.keys(this.variations).length+'</span>\n                </div>\n                <div class="col">\n                  <u>Classic Audiences</u><br><span>'+Object.keys(this.audiences).length+'</span>\n                </div>\n              </div>\n            </div><br>\n            <div id="ooo_filters" class="row center">\n              <div class="btn-group" data-toggle="buttons">\n                <span style="font-weight:bolder;font-size:16px;">Experiment Status:&emsp;</span>\n                <button class="btn info btn-info" filter="all">ALL EXPERIMENTS</button>\n                <button class="btn info btn-info" filter="live">LIVE EXPERIMENTS</button>\n                <button class="btn info btn-info" filter="paused">PAUSED EXPERIMENTS</button>\n              </div><br>\n              <div id="view_people" class="btn-group" data-toggle="button">\n                <span style="font-weight:bolder;font-size:16px;">Browse Visitor Criteria:&emsp;</span>\n                <button class="btn btn-warning" show="ooo_audiences" id="view_audiences">AUDIENCES</button>\n                <button class="btn btn-warning" show="ooo_visitor_you" id="view_visitor_you">YOUR SEGMENTS</button>\n                <button class="btn btn-warning" show="ooo_visitor_all" id="view_visitor_all">ALL SEGMENTS</button>\n                <button class="btn btn-warning btn-lg" show="my_variants" id="show_my_variants">MY EXPERIENCE</button>\n              </div>\n              <hr>\n              <section id="ooo_container_visitor" class="container">\n                <div class="row-fluid">\n                  <div style="display:none;" id="ooo_audiences" class="well blue col-xs-12">\n                    <a class="closeme">CLOSE</a> '+this.renderAudiences()+'\n                  </div>\n                  <div style="display:none;" id="ooo_visitor_you" class="well blue col-xs-12">\n                    <a class="closeme">CLOSE</a> '+this.renderYourSegments()+'\n                  </div>\n                  <div style="display:none;" id="ooo_visitor_all" class="well blue col-xs-12">\n                    <a class="closeme">CLOSE</a> '+this.renderAllSegments()+'\n                  </div>\n                  <div id="my_variants" class="center well alert alert-info" style="display:none">\n                    <a class="closeme">CLOSE</a> '+this.renderMyVariants()+'\n                  </div>\n                </div>\n              </section>\n\n            </div>\n            <div id="alert" class="center well alert alert-warning" style="display:none;">\n              <a class="closeme">CLOSE</a>\n            </div>\n          </section>\n          <section id="ooo_containerExperiments" class="container">\n          </section>\n        </div>\n      ').appendTo(this.$container),c=b.find('#ooo_containerExperiments'),d=b.find('#alert');a.each(this.getExperimentId().reverse(),(a,b)=>{c.append(this.addExperiment(b))}),b.find('.closeme').click(function(){a(this).parent().hide(),b.find('#ooo_filters > div >  button, #ooo_filters > div > label').removeClass('active')}),b.find('[filter]').click(function(){b.find('[experiment_id]').hide();let e=a(this).attr('filter');b.find('#ooo_container_visitor > div > div').hide();let f=c.find('.'+e+'Experiment').show();f.length?d.html('').css('display','none'):d.css('display','block').html('<h2> There are no '+('ooo'==e?'':e)+' experiments to show :(')}),b.find('#view_people button').click(function(){let c=a(this),d=c.attr('show'),e=b.find('#'+d),f=e.is(':visible');b.find('#ooo_container_visitor .well').hide(),e.css('display',f?'none':'block'),b.find('#ooo_filters > div >  button, #ooo_filters > div > label').removeClass('active')}),b.find('#show_my_variants').click(function(){let c=a(this),d=b.find(c.attr('show')),e=d.is(':visible');d.css('display',e?'none':'block'),b.find('#ooo_filters > div >  button, #ooo_filters > div > label').removeClass('active')})}getExperimentId(a){return a?this.experiments[a]?this.experiments[a]:alert('Experiment #'+a+' not found.'):Object.keys(this.experiments)}getExperimentName(a){return!!this.isExperiment(a)&&this.experiments[a].name}addExperiment(b){let c=this.experiments[b]||{},d=c.variation_ids||{},e=Object.keys(d).length,f=~a.inArray(b,this.state.activeExperiments),g=(c.section_ids.length?'MVT ('+c.section_ids.length+' Elements)':'A/B/n')+' | '+e+' Variations',h=f?'<label style="font-size:100%;" class="label label-success label-large show_variations">LIVE</label>':'<label style="font-size:100%;" class="label label-grey">Not Running</label>',i=a('<div experiment_id="'+b+'" class="row '+(f?' liveExperiment':' pausedExperiment')+' allExperiment">\n        <i class="icon-plus"></i>\n         <h3><a class="experiment_name">'+this.getExperimentName(b)+'</a></h3>&emsp;\n         <code class="show_variations">Experiment ID: '+b+'</code>&emsp;\n         <code class="show_variations">'+g+'</code>&emsp;\n         '+h+'&emsp;\n         '+(e?'<button class="show_variations btn btn-danger">View Variations</button>':'')+' &emsp;\n         '+(c.manual?'<label class="label label-warning">Manually Activated</label>':'')+'\n         '+(c.code?'&emsp;<button class="show_code btn btn-small btn-info">View Script</button><pre class="pre-scrollable script_display" style="display:none;">'+this.htmlspecialchars(c.code)+'</pre>':'')+'\n         <section style="display:none;" class="variation_section container"></section>\n      </div>'),j=i.find('.variation_section').append(this.renderVariationsSection(b));return i.find('.show_variations').click(function(){j.toggle(),i.find('button.show_variations').text(j.is(':visible')?'Hide Variations':'View Variations')}),i.find('.show_code').click(function(){let b=a(this),c=b.parent().find('pre');c.toggle(),b.text(c.is(':visible')?'Hide Script':'View Script')}),i}renderYourSegments(){if(!this.visitor.segments)return'<h2 class=\'center\'><label class=\'badge badge-danger\'>You are not part of any segments!</label></h2>';let c=this.visitor.segments,d=0,e='<h2>Here are the segments you are part of: </h2><br><br>';return a.each(c,(a,c)=>{this.segments[a]&&(e+='<label class=\'segment col-sm-5 label label-'+b[d]+'\'>'+this.segments[a].name+' = '+c+'</label>',d=3==d?0:d+1)}),e}renderAllSegments(){if(!this.segments)return'<h2 class=\'center\'><label class=\'badge badge-danger\'>There are no segments created.</label></h2>';let c='<h2>Here are all segments being targeted towards on this site: </h2><hr>',d=0;return a.each(this.segments,(a)=>{c+='<label class=\'segment col-sm-5 label label-'+b[d]+'\'>'+this.segments[a].name+'</label>',d=3==d?0:d+1}),c}renderMyVariants(){let c=window.optimizely.variationNamesMap||{},d=0,e='<h2>Here are the tests and variations you are currently a part of!</h2>';return c&&Object.keys(c).length?(a.each(c,(a,c)=>{e+='<label class=\'segment col-sm-12 label label-'+b[d]+'\' style=\'width:90%;left:5%;\'>&emsp;'+this.experiments[a].name+' - &emsp;<code>'+c+'</code></label>',d=3==d?0:d+1}),e):'<h2 class=\'center\'><label class=\'badge badge-danger\'>You are not in any experiments! Shame...</label></h2>'}renderAudiences(){if(!this.audiences)return'<h2 class=\'center\'><label badge badge-danger\'>There are no audiences created.</label></h2>';let c=0,d='<h2>Here are all audiences being observed in analytics on this site: </h2><hr>';return a.each(this.audiences,(a,e)=>{d+='<label class=\'segment col-sm-5 label label-'+b[c]+'\'>'+e.name+'</label>',c=3==c?0:c+1}),d}renderVariationsSection(b){let c=this.experiments[b],d=a('<div/>');return a.each(c.variation_ids,(c,e)=>{let f=this.variations[e].name,g=this.variations[e].code,h=(()=>{let a=location.href;return a+=(a.split('?')[1]?'&':'?')+'optimizely_x'+b+'='+c,'<a href="'+a+'" class="pull-right btn btn-primary" target="_blank">Preview Variation</a>'})(),i=a('\n          <div class="row oooExperiment_variation" variation_id="'+e+'">\n            <div class="col-sm-3">\n              <h3>'+f+' '+h+'</h3>\n            </div>\n            <div class="col-sm-9">\n              <pre class="col-sm-12">'+(g?this.htmlspecialchars(g):'Empty Variant Code')+'</pre>\n            </div>\n          </div>\n        ');d.append(i).append('<hr>')}),d}isExperiment(a){return!!this.experiments[a]}isVariation(a){return!!this.variations[a]}htmlspecialchars(a){return a.replace(/&/g,'&').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;')}static get styles(){return'\n        :host{\n          font-size: 13px;\n        }\n\n        #opt_backdrop {\n          position: fixed;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background: rgba(0, 0, 0, .4);\n          z-index: 99999998\n        }\n        #opt_container {\n          position: fixed;\n          overflow-y: auto;\n          background: #FFF;\n          padding: 20px;\n          left: 50%;\n          top: 50%;\n          border-radius: 4px;\n          box-shadow: 0 0 28px -1px black;\n          -webkit-box-shadow: 0 0 28px -1px black;\n          min-width: 300px;\n          min-height: 300px;\n          z-index: 99999999;\n        }\n        .well .col {\n          width: 25%;\n          float: left;\n          text-align: center;\n        }\n        .center {\n          text-align: center;\n        }\n        code {\n          padding: 2px 4px;\n          font-size: 90%;\n          color: #c7254e;\n          background-color: #f9f2f4;\n          white-space: nowrap;\n          border-radius: 4px;\n        }\n        .container {\n          width: 100% !important;\n        }\n        b {\n          font-weight: bold !important;\n        }\n        label {\n          display: inline-block;\n          margin: 5px;\n          padding: 5px;\n          border-radius: 3px;\n          color: black;\n        }\n        .btn {\n          padding: 10px;\n          border-radius: 2px;\n          -webkit-border-radius: 2px;\n          cursor: pointer;\n          border: 1px solid transparent;\n        }\n        .btn-info,\n        .label-info {\n          background: #428bca;\n          border-color: #357ebd;\n        }\n        .btn-info:hover,\n        .label-info:hover {\n          background: #3276b1;\n          border-color: #285e8e;\n        }\n        .btn-success,\n        .label-success {\n          background: #5cb85c;\n          border-color: #4cae4c;\n        }\n        .btn-success:hover,\n        .label-success:hover {\n          background: #47a447;\n          border-color: #398439;\n        }\n        .btn-warning,\n        .label-warning {\n          background: #f0ad4e;\n          border-color: #eea236\n        }\n        .btn-warning:hover,\n        .label-warning:hover {\n          background: #ed9c28;\n          border-color: #d58512;\n        }\n        .btn-danger,\n        .label-danger {\n          background: #d9534f;\n          border-color#d43f3a;\n        }\n        .btn-danger:hover,\n        .label-danger:hover {\n          background: #d2322d;\n          border-color#ac2925;\n        }\n        .btn-primary,\n        .label-primary {\n          background: #428bca;\n          color: black !important;\n          border-color: #357ebd;\n        }\n        .btn-primary:hover,\n        .label-primary:hover {\n          background: #3276b1;\n          border-color#285e8e;\n        }\n        pre {\n          width: 95%;\n          overflow: hidden;\n          word-wrap: break-word;\n        }\n        .row {\n          width: 100%;\n          display: inline-block;\n          margin: 0;\n          padding: 5px;\n        }\n        .well {\n          background-color: #f5f5f5;\n          padding: 10px;\n          border: 1px solid #e3e3e3;\n          box-shadow: inset 0 1px 1px rgba(0, 0, 0, .05);\n          -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .05);\n        }\n        .pull-right {\n          float: right\n        }\n        .pull-left {\n          float: left;\n        }\n        .closeme {\n          position: relative;\n          top: -7px;\n          right: -47%;\n          cursor: pointer;\n          font-size: 10px;\n          background: #FFF;\n          color: #35AFE3;\n          border-radius: 8px;\n          padding: 4px;\n        }\n        .segment {\n          float:none\n        }'}}let d=Math.random().toString().substr(2),e='optimizely-analysis-'+d;customElements.define(e,c);let f=document.createElement(e);document.body.appendChild(f)})();